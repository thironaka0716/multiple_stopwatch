<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>Stopwatch</title>
  <style>
    body {
      text-align: center;
      font-family: sans-serif;
      margin: 50px;
    }
    .time-display {
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 20px;
    }
    button {
      padding: 10px 20px;
      font-size: 1rem;
      margin: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <h1>ストップウォッチ</h1>

  <div class="time-display" id="timeDisplay">00:00:00</div>

  <button id="startStopBtn">START</button>
  <button id="resetBtn">RESET</button>

  <script>
    let startTime = 0;     // 計測開始時のタイムスタンプ
    let elapsedTime = 0;   // 合計経過時間 (ミリ秒)
    let timerId = null;    // setInterval() のID
    let running = false;   // 動作中フラグ

    const timeDisplay = document.getElementById('timeDisplay');
    const startStopBtn = document.getElementById('startStopBtn');
    const resetBtn = document.getElementById('resetBtn');

    // 時刻表示を更新する関数
    function updateTime() {
      const now = Date.now();
      const diff = now - startTime;     // 再開後の経過時間
      const total = elapsedTime + diff; // トータル経過時間

      // ミリ秒 -> 秒/分/時間に分解
      const ms = Math.floor((total % 1000) / 10);       // ミリ秒(2桁にしたいので÷10)
      const s  = Math.floor(total / 1000) % 60;         // 秒
      const m  = Math.floor(total / 60000) % 60;        // 分
      const h  = Math.floor(total / 3600000);           // 時 (必要なら表示)

      // 2桁表示 (ミリ秒は2桁、秒/分/時間は2桁)
      const hh = String(h).padStart(2, '0');
      const mm = String(m).padStart(2, '0');
      const ss = String(s).padStart(2, '0');
      const mss = String(ms).padStart(2, '0');  // 今回は2桁

      // 表示フォーマット（ここでは「HH:MM:SS」の後ろにミリ秒2桁）
      // 必要に応じて hh:mm:ss.ms にするか、mm:ss:ms だけにするなど調整してください。
      timeDisplay.textContent = `${hh}:${mm}:${ss}`;
    }

    // START/STOPボタン
    startStopBtn.addEventListener('click', () => {
      if (!running) {
        // START
        running = true;
        startStopBtn.textContent = 'STOP';
        startTime = Date.now();
        timerId = setInterval(updateTime, 10); // 10ms毎に更新
      } else {
        // STOP
        running = false;
        startStopBtn.textContent = 'START';
        clearInterval(timerId);
        timerId = null;
        // 最終的に経過時間を更新しておく
        const now = Date.now();
        elapsedTime += (now - startTime);
      }
    });

    // RESETボタン
    resetBtn.addEventListener('click', () => {
      running = false;
      if (timerId) {
        clearInterval(timerId);
        timerId = null;
      }
      startStopBtn.textContent = 'START';
      startTime = 0;
      elapsedTime = 0;
      timeDisplay.textContent = '00:00:00';
    });
  </script>
</body>
</html>
